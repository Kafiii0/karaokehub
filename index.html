<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Hybrid Karaoke</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --bg-dark: #0f0f13;
            --primary: #ff0055; /* Youtube Red */
            --accent: #ffffff;
            --text-main: #f8fafc;
            --text-dim: #94a3b8;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background-color: var(--bg-dark);
            color: var(--text-main);
            font-family: 'Poppins', sans-serif;
            display: flex; justify-content: center; min-height: 100vh; padding: 20px;
        }

        .container { width: 100%; max-width: 900px; display: flex; flex-direction: column; gap: 20px; }

        /* HEADER */
        header {
            text-align: center; padding: 15px; border-bottom: 1px solid #333;
        }
        header h1 {
            font-family: 'Orbitron', sans-serif; color: var(--primary); 
            text-transform: uppercase; letter-spacing: 2px;
        }

        /* PLAYER AREA */
        .stage-area {
            position: relative; width: 100%; padding-top: 56.25%; /* 16:9 */
            background: #000; border-radius: 12px; overflow: hidden;
            border: 2px solid #333;
        }
        #youtube-player { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }

        /* SEARCH BAR */
        .search-container {
            display: flex; gap: 10px;
        }
        input[type="text"] {
            flex-grow: 1; padding: 15px; border-radius: 8px; border: none;
            background: #1e1e24; color: white; font-size: 1rem;
        }
        input[type="text"]:focus { outline: 2px solid var(--primary); }
        
        .btn-search {
            padding: 0 25px; background: var(--primary); color: white; border: none;
            border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 1rem;
            transition: 0.2s;
        }
        .btn-search:hover { filter: brightness(1.2); }

        /* STATUS BADGE */
        .status-bar {
            text-align: center; font-size: 0.9rem; color: var(--text-dim);
        }
        .badge {
            padding: 3px 8px; border-radius: 4px; font-weight: bold; font-size: 0.75rem;
        }
        .badge-curated { background: #00e5ff; color: #000; } /* Biru: Database Lokal */
        .badge-yt { background: #ff0000; color: #fff; }       /* Merah: Live Search */

        /* RESULTS LIST */
        .results-list {
            list-style: none; display: flex; flex-direction: column; gap: 10px;
        }
        .video-item {
            display: flex; align-items: center; gap: 15px;
            background: #1e1e24; padding: 10px; border-radius: 8px;
            cursor: pointer; transition: 0.2s;
        }
        .video-item:hover { background: #2a2a32; transform: translateX(5px); }
        .thumb {
            width: 120px; height: 68px; object-fit: cover; border-radius: 4px;
        }
        .info h4 { font-size: 1rem; margin-bottom: 5px; line-height: 1.2; }
        .info p { font-size: 0.8rem; color: var(--text-dim); }

    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>A&W Karaoke <span style="color:white; font-size:0.5em;">System</span></h1>
        </header>

        <div class="stage-area">
            <div id="youtube-player"></div>
        </div>

        <div class="search-container">
            <input type="text" id="searchInput" placeholder="Ketik judul lagu (Contoh: Separuh Aku)..." onkeypress="handleEnter(event)">
            <button class="btn-search" onclick="performSearch()">CARI</button>
        </div>

        <div class="status-bar" id="statusMsg">Siap bernyanyi? Cari lagu di atas!</div>

        <ul class="results-list" id="resultsList">
            </ul>
    </div>

    <script>
        // ==========================================
        // üîë KONFIGURASI (WAJIB DIISI)
        // ==========================================
        const YOUTUBE_API_KEY = 'AIzaSyDI4Q4h3EkiH7mQzeQz7AygoMmvv_sRbBs'; 
        
        // ==========================================
        // üíø DATABASE LAGU PILIHAN (CURATED LIST)
        // ==========================================
        // Masukkan ID Video YouTube untuk lagu-lagu favorit Anda di sini.
        // Jika user mencari judul ini, video inilah yang PASTI diputar.
        const MY_DATABASE = [
            { keywords: ["separuh aku", "noah separuh"], id: "rS7R7Zz2aKY", title: "NOAH - Separuh Aku (Official Karaoke)" },
            { keywords: ["hampa", "ari lasso hampa"], id: "k-C53tq-m4E", title: "Ari Lasso - Hampa (HD Karaoke)" },
            { keywords: ["pupus", "dewa 19"], id: "mJ2L7lZqFzA", title: "Dewa 19 - Pupus (Karaoke Version)" },
            { keywords: ["avenged", "dear god"], id: "mzX0rhF8buE", title: "Avenged Sevenfold - Dear God (Karaoke)" }
        ];

        // ==========================================
        // üß† LOGIKA SISTEM
        // ==========================================
        
        let player; // Variabel global untuk player YouTube

        // 1. Load YouTube IFrame API
        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        function onYouTubeIframeAPIReady() {
            player = new YT.Player('youtube-player', {
                height: '100%',
                width: '100%',
                videoId: 'M7lc1UVf-VE', // Video Default (Intro)
                playerVars: { 'autoplay': 0, 'rel': 0, 'modestbranding': 1 },
                events: { 'onStateChange': onPlayerStateChange }
            });
        }

        function onPlayerStateChange(event) {
            // Bisa tambahkan logika auto-next di sini jika mau
        }

        // 2. Fungsi Utama Pencarian
        function handleEnter(e) {
            if (e.key === 'Enter') performSearch();
        }

        async function performSearch() {
            const query = document.getElementById('searchInput').value.toLowerCase().trim();
            const resultsList = document.getElementById('resultsList');
            const statusMsg = document.getElementById('statusMsg');
            
            if (!query) return;

            resultsList.innerHTML = '<li style="padding:10px; text-align:center;">üîç Sedang mencari...</li>';

            // --- TAHAP A: Cek Database Lokal (Curated) ---
            // Kita cari apakah ada keyword yang cocok di database lokal
            const localMatch = MY_DATABASE.find(song => 
                song.keywords.some(keyword => query.includes(keyword))
            );

            if (localMatch) {
                // JIKA KETEMU DI DATABASE LOKAL
                statusMsg.innerHTML = `<span class="badge badge-curated">DATABASE LOKAL</span> Lagu ditemukan di koleksi pribadi!`;
                loadVideo(localMatch.id);
                resultsList.innerHTML = ''; // Bersihkan list
                return;
            }

            // --- TAHAP B: Cari di YouTube API (Jika tidak ada di lokal) ---
            statusMsg.innerHTML = `<span class="badge badge-yt">YOUTUBE SEARCH</span> Mencari di YouTube Server...`;
            
            try {
                // Tambahkan kata "Karaoke" otomatis agar hasilnya relevan
                const searchQ = encodeURIComponent(query + " karaoke instrument");
                const url = `https://www.googleapis.com/youtube/v3/search?part=snippet&maxResults=5&q=${searchQ}&type=video&key=${YOUTUBE_API_KEY}`;
                
                const res = await fetch(url);
                const data = await res.json();

                if (data.error) {
                    throw new Error(data.error.message);
                }

                displayResults(data.items);

            } catch (error) {
                console.error(error);
                resultsList.innerHTML = `<li style="padding:10px; color:red;">Gagal: ${error.message}. <br>Cek API Key Anda.</li>`;
            }
        }

        // 3. Menampilkan Hasil YouTube
        function displayResults(videos) {
            const resultsList = document.getElementById('resultsList');
            resultsList.innerHTML = '';

            if (videos.length === 0) {
                resultsList.innerHTML = '<li>Tidak ditemukan hasil.</li>';
                return;
            }

            videos.forEach(video => {
                const title = video.snippet.title;
                const thumb = video.snippet.thumbnails.medium.url;
                const channel = video.snippet.channelTitle;
                const videoId = video.id.videoId;

                const li = document.createElement('li');
                li.className = 'video-item';
                li.innerHTML = `
                    <img src="${thumb}" class="thumb">
                    <div class="info">
                        <h4>${title}</h4>
                        <p>${channel}</p>
                    </div>
                `;
                li.onclick = () => {
                    loadVideo(videoId);
                    // Scroll ke atas (player)
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                };
                resultsList.appendChild(li);
            });
        }

        // 4. Memutar Video
        function loadVideo(id) {
            if (player && player.loadVideoById) {
                player.loadVideoById(id);
            }
        }
    </script>
</body>
</html>
